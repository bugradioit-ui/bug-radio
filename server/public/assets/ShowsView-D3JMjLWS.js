import{u as ve,D as ce}from"./DashboardLayout-pOp1z0Uu.js";import{a as pe,n as me,r as b,j as c,k as fe,l as k,w as u,e as d,p as ge,o as y,d as i,b as l,h as z,c as U,m as $,F as be,q as ye,t as N,s as Se,v as we,x as C,y as B}from"./index-DvqxKvF9.js";import{I as O}from"./ImageUpload-B14NK2BC.js";import{_ as he}from"./_plugin-vue_export-helper-DlAUqK2U.js";const Ve={class:"filters"},Ce={class:"empty-state"},ke={class:"genres-tags"},qe={key:0,class:"more-genres"},Ae={class:"action-buttons"},$e={class:"dialog-content"},Ie={class:"form-section"},Te={class:"form-field"},Re={class:"form-field"},_e={class:"form-field"},De={class:"form-section"},Ee={class:"form-field"},xe={class:"form-field"},Le={class:"form-field"},je={class:"form-field"},ze={class:"form-section"},Ue={class:"form-field"},Ne={class:"form-field"},Be={class:"form-section"},Oe={class:"form-row"},Fe={class:"form-field"},Me={class:"form-field"},Ge={class:"form-field"},He={class:"checkbox-field"},Je={__name:"ShowsView",setup(Ke){const n=ve(),v=pe(),I=me(),T="https://bug-radio.onrender.com/api",S=b(!1),f=b(null),s=b("pending"),o=b({title:"",description:"",artist:{name:"",bio:"",email:"",photo:"",socialLinks:{}},image:{url:"",alt:""},genres:[],tags:[],requestStatus:"pending",status:"active",featured:!1}),w=b(""),g=b(""),F=[{label:"In Attesa",value:"pending"},{label:"Approvato",value:"approved"},{label:"Rifiutato",value:"rejected"}],M=[{label:"Attivo",value:"active"},{label:"Inattivo",value:"inactive"},{label:"Archiviato",value:"archived"}],R=c(()=>n.shows.filter(t=>t.requestStatus==="pending")),_=c(()=>n.shows.filter(t=>t.status==="active"&&t.requestStatus==="approved")),D=c(()=>n.shows.filter(t=>t.status==="inactive")),E=c(()=>n.shows.filter(t=>t.requestStatus==="rejected")),G=c(()=>R.value.length),H=c(()=>_.value.length),J=c(()=>D.value.length),K=c(()=>E.value.length),Q=c(()=>{switch(s.value){case"pending":return R.value;case"active":return _.value;case"inactive":return D.value;case"rejected":return E.value;case"all":return n.shows;default:return n.shows}}),W=()=>({pending:"in attesa di approvazione",active:"attivo",inactive:"inattivo",rejected:"rifiutato",all:""})[s.value]||"",X=t=>({pending:"IN ATTESA",approved:"APPROVATO",rejected:"RIFIUTATO"})[t]||t?.toUpperCase(),Y=t=>({pending:"warning",approved:"success",rejected:"danger"})[t]||"info",Z=t=>({active:"ATTIVO",inactive:"INATTIVO",archived:"ARCHIVIATO"})[t]||t?.toUpperCase(),P=t=>({active:"success",inactive:"warning",archived:"secondary"})[t]||"info",q=(t=null)=>{t?(f.value=t,o.value={title:t.title,description:t.description,artist:{name:t.artist?.name||"",bio:t.artist?.bio||"",email:t.artist?.email||"",photo:t.artist?.photo||"",socialLinks:t.artist?.socialLinks||{}},image:{url:t.image?.url||"",alt:t.image?.alt||""},genres:t.genres||[],tags:t.tags||[],requestStatus:t.requestStatus,status:t.status,featured:t.featured},w.value=(t.genres||[]).join(", "),g.value=(t.tags||[]).join(", ")):(f.value=null,o.value={title:"",description:"",artist:{name:"",bio:"",email:"",photo:"",socialLinks:{}},image:{url:"",alt:""},genres:[],tags:[],requestStatus:"pending",status:"active",featured:!1},w.value="",g.value=""),S.value=!0},ee=async()=>{if(!o.value.title||!o.value.description||!o.value.artist.name){v.add({severity:"warn",summary:"Attenzione",detail:"Compila i campi obbligatori (titolo, descrizione, artista)",life:3e3});return}const t={title:o.value.title,description:o.value.description,artist:{name:o.value.artist.name,bio:o.value.artist.bio||"",email:o.value.artist.email||"",photo:o.value.artist.photo||"",socialLinks:o.value.artist.socialLinks||{}},image:{url:o.value.image.url||"",alt:o.value.image.alt||""},genres:w.value.split(",").map(e=>e.trim()).filter(e=>e),tags:g.value?g.value.split(",").map(e=>e.trim()).filter(e=>e):[],requestStatus:o.value.requestStatus,status:o.value.status,featured:o.value.featured};try{f.value?(await n.updateShow(f.value._id,t),v.add({severity:"success",summary:"Show aggiornato",detail:"Le modifiche sono state salvate",life:3e3})):(await n.createShow(t),v.add({severity:"success",summary:"Show creato",detail:"Il nuovo show Ã¨ stato creato con successo",life:3e3})),S.value=!1}catch{v.add({severity:"error",summary:"Errore",detail:n.error||"Errore durante il salvataggio",life:3e3})}},te=t=>{alert(`Dettagli show:

Titolo: ${t.title}
Slug: ${t.slug}
Status: ${t.status}
Request Status: ${t.requestStatus}`)},ae=async t=>{I.require({message:`Vuoi approvare lo show "${t.title}" di ${t.artist.name}?`,header:"Approva Richiesta",icon:"pi pi-check-circle",acceptLabel:"SÃ¬, approva",rejectLabel:"Annulla",acceptClass:"p-button-success",accept:async()=>{try{await B.put(`${T}/admin/shows/${t._id}/approve`,{adminNotes:"Show approvato! Benvenuto su BUG Radio ðŸŽµ"}),v.add({severity:"success",summary:"Show Approvato!",detail:`"${t.title}" Ã¨ stato approvato e attivato`,life:4e3}),await n.fetchShows()}catch{v.add({severity:"error",summary:"Errore",detail:"Errore nell'approvazione",life:3e3})}}})},le=async t=>{const e=prompt(`Motivo del rifiuto per "${t.title}":`,"Il contenuto non Ã¨ adatto alla nostra programmazione.");if(e)try{await B.put(`${T}/admin/shows/${t._id}/reject`,{adminNotes:e}),v.add({severity:"info",summary:"Show Rifiutato",detail:`"${t.title}" Ã¨ stato rifiutato`,life:3e3}),await n.fetchShows()}catch{v.add({severity:"error",summary:"Errore",detail:"Errore nel rifiuto",life:3e3})}},ie=t=>{I.require({message:`Sei sicuro di voler eliminare "${t.title}"?`,header:"Conferma Eliminazione",icon:"pi pi-exclamation-triangle",acceptLabel:"SÃ¬, elimina",rejectLabel:"Annulla",acceptClass:"p-button-danger",accept:()=>oe(t)})},oe=async t=>{try{await n.deleteShow(t._id),v.add({severity:"success",summary:"Show eliminato",detail:"Lo show Ã¨ stato eliminato",life:3e3})}catch{v.add({severity:"error",summary:"Errore",detail:"Errore durante l'eliminazione",life:3e3})}};return fe(async()=>{try{await n.fetchShows()}catch{v.add({severity:"error",summary:"Errore",detail:"Errore nel caricamento degli show",life:3e3})}}),(t,e)=>{const r=d("Button"),x=d("Card"),p=d("Column"),A=d("Tag"),se=d("DataTable"),h=d("InputText"),L=d("Textarea"),j=d("Dropdown"),ne=d("Checkbox"),re=d("Dialog"),ue=d("ConfirmDialog"),de=d("Toast"),V=ge("tooltip");return y(),k(ce,{"page-title":"Gestione Shows"},{"topbar-actions":u(()=>[i(r,{label:"Nuovo Show",icon:"pi pi-plus",onClick:e[0]||(e[0]=a=>q())})]),default:u(()=>[i(x,{class:"filters-card"},{content:u(()=>[l("div",Ve,[i(r,{label:`Richieste Pending (${G.value})`,severity:s.value==="pending"?"warning":"secondary",outlined:s.value!=="pending",onClick:e[1]||(e[1]=a=>s.value="pending"),icon:"pi pi-clock"},null,8,["label","severity","outlined"]),i(r,{label:`Attivi (${H.value})`,severity:s.value==="active"?"success":"secondary",outlined:s.value!=="active",onClick:e[2]||(e[2]=a=>s.value="active"),icon:"pi pi-check-circle"},null,8,["label","severity","outlined"]),i(r,{label:`Inattivi (${J.value})`,severity:s.value==="inactive"?"info":"secondary",outlined:s.value!=="inactive",onClick:e[3]||(e[3]=a=>s.value="inactive"),icon:"pi pi-pause"},null,8,["label","severity","outlined"]),i(r,{label:`Rifiutati (${K.value})`,severity:s.value==="rejected"?"danger":"secondary",outlined:s.value!=="rejected",onClick:e[4]||(e[4]=a=>s.value="rejected"),icon:"pi pi-times"},null,8,["label","severity","outlined"]),i(r,{label:"Tutti",severity:s.value==="all"?"contrast":"secondary",outlined:s.value!=="all",onClick:e[5]||(e[5]=a=>s.value="all"),icon:"pi pi-list"},null,8,["severity","outlined"])])]),_:1}),i(x,null,{content:u(()=>[i(se,{value:Q.value,loading:z(n).loading,paginator:"",rows:10,stripedRows:"",sortField:"updatedAt",sortOrder:-1},{empty:u(()=>[l("div",Ce,[e[21]||(e[21]=l("i",{class:"pi pi-microphone",style:{"font-size":"3rem",color:"#cbd5e1"}},null,-1)),l("p",null,"Nessuno show "+N(W()),1),i(r,{label:"Crea il primo show",icon:"pi pi-plus",onClick:e[6]||(e[6]=a=>q())})])]),default:u(()=>[i(p,{field:"title",header:"Titolo",sortable:"",style:{"min-width":"200px"}}),i(p,{field:"artist.name",header:"Artista",sortable:""}),i(p,{field:"artist.email",header:"Email",sortable:""}),i(p,{field:"genres",header:"Generi"},{body:u(a=>[l("div",ke,[(y(!0),U(be,null,ye(a.data.genres?.slice(0,2),m=>(y(),k(A,{key:m,value:m,severity:"info",class:"genre-tag"},null,8,["value"]))),128)),a.data.genres?.length>2?(y(),U("span",qe," +"+N(a.data.genres.length-2),1)):$("",!0)])]),_:1}),i(p,{field:"requestStatus",header:"Status Richiesta",sortable:""},{body:u(a=>[i(A,{value:X(a.data.requestStatus),severity:Y(a.data.requestStatus)},null,8,["value","severity"])]),_:1}),i(p,{field:"status",header:"Status Show",sortable:""},{body:u(a=>[i(A,{value:Z(a.data.status),severity:P(a.data.status)},null,8,["value","severity"])]),_:1}),i(p,{field:"featured",header:"Featured",sortable:""},{body:u(a=>[l("i",{class:we(a.data.featured?"pi pi-star-fill":"pi pi-star"),style:Se({color:a.data.featured?"#f59e0b":"#cbd5e1"})},null,6)]),_:1}),i(p,{header:"Azioni",style:{width:"250px"}},{body:u(a=>[l("div",Ae,[a.data.requestStatus==="pending"?C((y(),k(r,{key:0,icon:"pi pi-check",rounded:"",severity:"success",onClick:m=>ae(a.data)},null,8,["onClick"])),[[V,"Approva Richiesta",void 0,{top:!0}]]):$("",!0),a.data.requestStatus==="pending"?C((y(),k(r,{key:1,icon:"pi pi-times",rounded:"",severity:"danger",onClick:m=>le(a.data)},null,8,["onClick"])),[[V,"Rifiuta Richiesta",void 0,{top:!0}]]):$("",!0),C(i(r,{icon:"pi pi-eye",rounded:"",outlined:"",severity:"info",onClick:m=>te(a.data)},null,8,["onClick"]),[[V,"Dettagli",void 0,{top:!0}]]),C(i(r,{icon:"pi pi-pencil",rounded:"",outlined:"",severity:"secondary",onClick:m=>q(a.data)},null,8,["onClick"]),[[V,"Modifica",void 0,{top:!0}]]),C(i(r,{icon:"pi pi-trash",rounded:"",outlined:"",severity:"danger",onClick:m=>ie(a.data)},null,8,["onClick"]),[[V,"Elimina",void 0,{top:!0}]])])]),_:1})]),_:1},8,["value","loading"])]),_:1}),i(re,{visible:S.value,"onUpdate:visible":e[20]||(e[20]=a=>S.value=a),header:f.value?"Modifica Show":"Nuovo Show",modal:!0,style:{width:"800px"},maximizable:!0},{footer:u(()=>[i(r,{label:"Annulla",severity:"secondary",onClick:e[19]||(e[19]=a=>S.value=!1),outlined:""}),i(r,{label:f.value?"Salva Modifiche":"Crea Show",onClick:ee,loading:z(n).loading},null,8,["label","loading"])]),default:u(()=>[l("div",$e,[l("div",Ie,[e[24]||(e[24]=l("h3",null,"Informazioni Show",-1)),l("div",Te,[i(O,{label:"Immagine Copertina Show",modelValue:o.value.image.url,"onUpdate:modelValue":e[7]||(e[7]=a=>o.value.image.url=a)},null,8,["modelValue"])]),l("div",Re,[e[22]||(e[22]=l("label",{for:"title"},"Titolo Show *",-1)),i(h,{id:"title",modelValue:o.value.title,"onUpdate:modelValue":e[8]||(e[8]=a=>o.value.title=a),placeholder:"Es. Noise Ã  Noise",class:"w-full"},null,8,["modelValue"])]),l("div",_e,[e[23]||(e[23]=l("label",{for:"description"},"Descrizione *",-1)),i(L,{id:"description",modelValue:o.value.description,"onUpdate:modelValue":e[9]||(e[9]=a=>o.value.description=a),rows:"5",placeholder:"Descrivi lo show...",class:"w-full"},null,8,["modelValue"])])]),l("div",De,[e[28]||(e[28]=l("h3",null,"Informazioni Artista",-1)),l("div",Ee,[i(O,{label:"Foto Artista",modelValue:o.value.artist.photo,"onUpdate:modelValue":e[10]||(e[10]=a=>o.value.artist.photo=a)},null,8,["modelValue"])]),l("div",xe,[e[25]||(e[25]=l("label",{for:"artistName"},"Nome Artista *",-1)),i(h,{id:"artistName",modelValue:o.value.artist.name,"onUpdate:modelValue":e[11]||(e[11]=a=>o.value.artist.name=a),placeholder:"Nome curatore/artista",class:"w-full"},null,8,["modelValue"])]),l("div",Le,[e[26]||(e[26]=l("label",{for:"artistBio"},"Bio Artista",-1)),i(L,{id:"artistBio",modelValue:o.value.artist.bio,"onUpdate:modelValue":e[12]||(e[12]=a=>o.value.artist.bio=a),rows:"3",placeholder:"Biografia dell'artista...",class:"w-full"},null,8,["modelValue"])]),l("div",je,[e[27]||(e[27]=l("label",{for:"artistEmail"},"Email Artista",-1)),i(h,{id:"artistEmail",modelValue:o.value.artist.email,"onUpdate:modelValue":e[13]||(e[13]=a=>o.value.artist.email=a),type:"email",placeholder:"email@example.com",class:"w-full"},null,8,["modelValue"])])]),l("div",ze,[e[32]||(e[32]=l("h3",null,"Generi e Tags",-1)),l("div",Ue,[e[29]||(e[29]=l("label",{for:"genres"},"Generi (separati da virgola)",-1)),i(h,{id:"genres",modelValue:w.value,"onUpdate:modelValue":e[14]||(e[14]=a=>w.value=a),placeholder:"Ambient, Experimental, Drone",class:"w-full"},null,8,["modelValue"]),e[30]||(e[30]=l("small",null,"Inserisci i generi separati da virgola",-1))]),l("div",Ne,[e[31]||(e[31]=l("label",{for:"tags"},"Tags (separati da virgola)",-1)),i(h,{id:"tags",modelValue:g.value,"onUpdate:modelValue":e[15]||(e[15]=a=>g.value=a),placeholder:"underground, electronic, live",class:"w-full"},null,8,["modelValue"])])]),l("div",Be,[e[37]||(e[37]=l("h3",null,"Impostazioni",-1)),l("div",Oe,[l("div",Fe,[e[33]||(e[33]=l("label",{for:"requestStatus"},"Status Richiesta",-1)),i(j,{id:"requestStatus",modelValue:o.value.requestStatus,"onUpdate:modelValue":e[16]||(e[16]=a=>o.value.requestStatus=a),options:F,optionLabel:"label",optionValue:"value",placeholder:"Seleziona status",class:"w-full"},null,8,["modelValue"])]),l("div",Me,[e[34]||(e[34]=l("label",{for:"status"},"Status Show",-1)),i(j,{id:"status",modelValue:o.value.status,"onUpdate:modelValue":e[17]||(e[17]=a=>o.value.status=a),options:M,optionLabel:"label",optionValue:"value",placeholder:"Seleziona status",class:"w-full"},null,8,["modelValue"])])]),l("div",Ge,[e[36]||(e[36]=l("label",{for:"featured"},"In Evidenza",-1)),l("div",He,[i(ne,{id:"featured",modelValue:o.value.featured,"onUpdate:modelValue":e[18]||(e[18]=a=>o.value.featured=a),binary:!0},null,8,["modelValue"]),e[35]||(e[35]=l("label",{for:"featured"},"Mostra in homepage",-1))])])])])]),_:1},8,["visible","header"]),i(ue),i(de)]),_:1})}}},Ze=he(Je,[["__scopeId","data-v-3e731a24"]]);export{Ze as default};
