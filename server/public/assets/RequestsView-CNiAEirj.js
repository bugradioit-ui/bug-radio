import{u as ae,D as ie}from"./DashboardLayout-pOp1z0Uu.js";import{a as oe,r as w,j as D,k as ne,l as b,w as u,y as L,e as f,p as re,o,d as i,b as t,c as p,m as d,F as G,q as M,t as n,i as m,x as V}from"./index-DvqxKvF9.js";import{_ as ue}from"./_plugin-vue_export-helper-DlAUqK2U.js";const de={class:"topbar-badge"},ve={class:"filters"},pe={class:"empty-state"},ge={class:"genres-tags"},me={key:0,class:"more-genres"},ce={class:"action-buttons"},fe={key:0,class:"dialog-content"},ye={class:"dialog-message"},we={class:"form-field"},be={key:0,class:"dialog-content"},ke={class:"dialog-message warning"},Se={class:"form-field"},_e={key:0,class:"details-content"},Ae={class:"detail-row"},Re={class:"detail-section"},qe={key:0,class:"detail-row"},De={class:"image-preview-small"},Ce=["src","alt"],he={class:"detail-row"},$e={class:"detail-row"},xe={class:"detail-row"},Te={class:"detail-row"},je={class:"genres-tags"},Ne={key:1,class:"detail-row"},Le={class:"detail-section"},Ve={key:0,class:"detail-row"},Be={class:"image-preview-small"},Ie=["src","alt"],ze={class:"detail-row"},Ee={class:"detail-row"},Fe={class:"detail-row"},Ue={key:1,class:"detail-row"},Oe={class:"social-links"},Ge=["href"],Me=["href"],We=["href"],He={class:"detail-section"},Je={class:"detail-row"},Ke={class:"detail-row"},Qe={class:"detail-row"},Xe={key:0,class:"detail-section"},Ye={class:"detail-section"},Ze={class:"detail-row"},Pe={class:"detail-row"},et={__name:"RequestsView",setup(tt){const h="https://bug-radio.onrender.com/api";ae();const k=oe(),S=w([]),c=w(!1),r=w("pending"),_=w(!1),A=w(!1),R=w(!1),l=w(null),g=w(""),B=D(()=>S.value.filter(a=>a.requestStatus==="pending")),I=D(()=>S.value.filter(a=>a.requestStatus==="approved")),z=D(()=>S.value.filter(a=>a.requestStatus==="rejected")),$=D(()=>B.value.length),W=D(()=>r.value==="all"?S.value:r.value==="pending"?B.value:r.value==="approved"?I.value:r.value==="rejected"?z.value:S.value),E=a=>({pending:"IN ATTESA",approved:"APPROVATO",rejected:"RIFIUTATO"})[a]||a,F=a=>({pending:"warning",approved:"success",rejected:"danger"})[a]||"info",H=()=>({all:"",pending:"in attesa",approved:"approvata",rejected:"rifiutata"})[r.value]||"",x=a=>a?new Date(a).toLocaleDateString("it-IT",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"-",J=a=>{const e=a.artist.socialLinks;return e&&(e.instagram||e.soundcloud||e.mixcloud)},T=async()=>{c.value=!0;try{const a=await L.get(`${h}/shows`);S.value=a.data}catch{k.add({severity:"error",summary:"Errore",detail:"Errore nel caricamento delle richieste",life:3e3})}finally{c.value=!1}},K=a=>{l.value=a,g.value="Ottima proposta! Benvenuto su BUG Radio ðŸŽµ",_.value=!0},Q=a=>{l.value=a,g.value="",A.value=!0},X=()=>{R.value=!1,g.value="Ottima proposta! Benvenuto su BUG Radio ðŸŽµ",_.value=!0},Y=()=>{R.value=!1,g.value="",A.value=!0},Z=a=>{l.value=a,R.value=!0},P=async()=>{c.value=!0;try{await L.put(`${h}/admin/shows/${l.value._id}/approve`,{adminNotes:g.value}),k.add({severity:"success",summary:"Show Approvato!",detail:`"${l.value.title}" Ã¨ stato approvato e attivato`,life:4e3}),_.value=!1,await T()}catch(a){k.add({severity:"error",summary:"Errore",detail:a.response?.data?.error||"Errore nell'approvazione",life:3e3})}finally{c.value=!1}},ee=async()=>{if(!g.value.trim()){k.add({severity:"warn",summary:"Attenzione",detail:"Inserisci il motivo del rifiuto",life:3e3});return}c.value=!0;try{await L.put(`${h}/admin/shows/${l.value._id}/reject`,{adminNotes:g.value}),k.add({severity:"info",summary:"Show Rifiutato",detail:`"${l.value.title}" Ã¨ stato rifiutato`,life:3e3}),A.value=!1,await T()}catch(a){k.add({severity:"error",summary:"Errore",detail:a.response?.data?.error||"Errore nel rifiuto",life:3e3})}finally{c.value=!1}};return ne(async()=>{await T()}),(a,e)=>{const te=f("Badge"),v=f("Button"),U=f("Card"),y=f("Column"),C=f("Tag"),le=f("DataTable"),O=f("Textarea"),j=f("Dialog"),se=f("Toast"),N=re("tooltip");return o(),b(ie,{"page-title":"Gestione Richieste Show"},{"topbar-actions":u(()=>[t("div",de,[i(te,{value:$.value,severity:"warning"},null,8,["value"]),t("span",null,n($.value)+" in attesa",1)])]),default:u(()=>[i(U,{class:"filters-card"},{content:u(()=>[t("div",ve,[i(v,{label:`In Attesa (${$.value})`,severity:r.value==="pending"?"warning":"secondary",outlined:r.value!=="pending",onClick:e[0]||(e[0]=s=>r.value="pending")},null,8,["label","severity","outlined"]),i(v,{label:`Approvati (${I.value.length})`,severity:r.value==="approved"?"success":"secondary",outlined:r.value!=="approved",onClick:e[1]||(e[1]=s=>r.value="approved")},null,8,["label","severity","outlined"]),i(v,{label:`Rifiutati (${z.value.length})`,severity:r.value==="rejected"?"danger":"secondary",outlined:r.value!=="rejected",onClick:e[2]||(e[2]=s=>r.value="rejected")},null,8,["label","severity","outlined"]),i(v,{label:"Tutti",severity:r.value==="all"?"info":"secondary",outlined:r.value!=="all",onClick:e[3]||(e[3]=s=>r.value="all")},null,8,["severity","outlined"])])]),_:1}),i(U,null,{content:u(()=>[i(le,{value:W.value,loading:c.value,paginator:"",rows:15,stripedRows:"",sortField:"createdAt",sortOrder:-1},{empty:u(()=>[t("div",pe,[e[14]||(e[14]=t("i",{class:"pi pi-inbox",style:{"font-size":"3rem",color:"#cbd5e1"}},null,-1)),t("p",null,"Nessuna richiesta "+n(H()),1)])]),default:u(()=>[i(y,{field:"title",header:"Titolo Show",sortable:"",style:{"min-width":"200px"}}),i(y,{field:"artist.name",header:"Artista",sortable:""}),i(y,{field:"artist.email",header:"Email",sortable:""}),i(y,{field:"genres",header:"Generi"},{body:u(s=>[t("div",ge,[(o(!0),p(G,null,M(s.data.genres?.slice(0,2),q=>(o(),b(C,{key:q,value:q,severity:"info",class:"genre-tag"},null,8,["value"]))),128)),s.data.genres?.length>2?(o(),p("span",me," +"+n(s.data.genres.length-2),1)):d("",!0)])]),_:1}),i(y,{field:"schedule.dayOfWeek",header:"Giorno",sortable:""}),i(y,{field:"requestStatus",header:"Status",sortable:""},{body:u(s=>[i(C,{value:E(s.data.requestStatus),severity:F(s.data.requestStatus)},null,8,["value","severity"])]),_:1}),i(y,{field:"createdAt",header:"Data Richiesta",sortable:""},{body:u(s=>[m(n(x(s.data.createdAt)),1)]),_:1}),i(y,{header:"Azioni",style:{width:"200px"}},{body:u(s=>[t("div",ce,[s.data.requestStatus==="pending"?V((o(),b(v,{key:0,icon:"pi pi-check",rounded:"",severity:"success",onClick:q=>K(s.data)},null,8,["onClick"])),[[N,"Approva",void 0,{top:!0}]]):d("",!0),s.data.requestStatus==="pending"?V((o(),b(v,{key:1,icon:"pi pi-times",rounded:"",severity:"danger",onClick:q=>Q(s.data)},null,8,["onClick"])),[[N,"Rifiuta",void 0,{top:!0}]]):d("",!0),V(i(v,{icon:"pi pi-eye",rounded:"",outlined:"",severity:"info",onClick:q=>Z(s.data)},null,8,["onClick"]),[[N,"Dettagli",void 0,{top:!0}]])])]),_:1})]),_:1},8,["value","loading"])]),_:1}),i(j,{visible:_.value,"onUpdate:visible":e[6]||(e[6]=s=>_.value=s),header:"Approva Show",modal:!0,style:{width:"600px"}},{footer:u(()=>[i(v,{label:"Annulla",severity:"secondary",onClick:e[5]||(e[5]=s=>_.value=!1),outlined:""}),i(v,{label:"Approva Show",severity:"success",icon:"pi pi-check",onClick:P,loading:c.value},null,8,["loading"])]),default:u(()=>[l.value?(o(),p("div",fe,[t("p",ye,[e[15]||(e[15]=m(" Stai per approvare lo show ",-1)),t("strong",null,'"'+n(l.value.title)+'"',1),e[16]||(e[16]=m(" di ",-1)),t("strong",null,n(l.value.artist.name),1),e[17]||(e[17]=m(". ",-1))]),e[19]||(e[19]=t("p",{class:"dialog-message"}," Lo show verrÃ  attivato e reso visibile sul sito pubblico. ",-1)),t("div",we,[e[18]||(e[18]=t("label",{for:"approveNotes"},"Note per l'artista (opzionale)",-1)),i(O,{id:"approveNotes",modelValue:g.value,"onUpdate:modelValue":e[4]||(e[4]=s=>g.value=s),rows:"3",placeholder:"Es. Ottima proposta! Benvenuto su BUG Radio...",class:"w-full"},null,8,["modelValue"])])])):d("",!0)]),_:1},8,["visible"]),i(j,{visible:A.value,"onUpdate:visible":e[9]||(e[9]=s=>A.value=s),header:"Rifiuta Show",modal:!0,style:{width:"600px"}},{footer:u(()=>[i(v,{label:"Annulla",severity:"secondary",onClick:e[8]||(e[8]=s=>A.value=!1),outlined:""}),i(v,{label:"Rifiuta Show",severity:"danger",icon:"pi pi-times",onClick:ee,loading:c.value},null,8,["loading"])]),default:u(()=>[l.value?(o(),p("div",be,[t("p",ke,[e[20]||(e[20]=m(" Stai per rifiutare lo show ",-1)),t("strong",null,'"'+n(l.value.title)+'"',1),e[21]||(e[21]=m(" di ",-1)),t("strong",null,n(l.value.artist.name),1),e[22]||(e[22]=m(". ",-1))]),t("div",Se,[e[23]||(e[23]=t("label",{for:"rejectNotes"},"Motivo del rifiuto *",-1)),i(O,{id:"rejectNotes",modelValue:g.value,"onUpdate:modelValue":e[7]||(e[7]=s=>g.value=s),rows:"4",placeholder:"Spiega il motivo del rifiuto...",required:"",class:"w-full"},null,8,["modelValue"]),e[24]||(e[24]=t("small",null,"L'artista riceverÃ  questa motivazione",-1))])])):d("",!0)]),_:1},8,["visible"]),i(j,{visible:R.value,"onUpdate:visible":e[13]||(e[13]=s=>R.value=s),header:"Dettagli Richiesta Show",modal:!0,style:{width:"800px"},maximizable:!0},{footer:u(()=>[i(v,{label:"Chiudi",onClick:e[10]||(e[10]=s=>R.value=!1)}),l.value?.requestStatus==="pending"?(o(),b(v,{key:0,label:"Approva",severity:"success",icon:"pi pi-check",onClick:e[11]||(e[11]=s=>X())})):d("",!0),l.value?.requestStatus==="pending"?(o(),b(v,{key:1,label:"Rifiuta",severity:"danger",icon:"pi pi-times",onClick:e[12]||(e[12]=s=>Y())})):d("",!0)]),default:u(()=>[l.value?(o(),p("div",_e,[t("div",Ae,[e[25]||(e[25]=t("strong",null,"Status:",-1)),i(C,{value:E(l.value.requestStatus),severity:F(l.value.requestStatus)},null,8,["value","severity"])]),t("div",Re,[e[32]||(e[32]=t("h3",null,"ðŸ“» Informazioni Show",-1)),l.value.image?.url?(o(),p("div",qe,[e[26]||(e[26]=t("strong",null,"Immagine Show:",-1)),t("div",De,[t("img",{src:l.value.image.url,alt:l.value.title},null,8,Ce)])])):d("",!0),t("div",he,[e[27]||(e[27]=t("strong",null,"Titolo:",-1)),t("span",null,n(l.value.title),1)]),t("div",$e,[e[28]||(e[28]=t("strong",null,"Slug:",-1)),t("span",null,n(l.value.slug),1)]),t("div",xe,[e[29]||(e[29]=t("strong",null,"Descrizione:",-1)),t("p",null,n(l.value.description),1)]),t("div",Te,[e[30]||(e[30]=t("strong",null,"Generi:",-1)),t("div",je,[(o(!0),p(G,null,M(l.value.genres,s=>(o(),b(C,{key:s,value:s,severity:"info"},null,8,["value"]))),128))])]),l.value.tags?.length?(o(),p("div",Ne,[e[31]||(e[31]=t("strong",null,"Tags:",-1)),t("span",null,n(l.value.tags.join(", ")),1)])):d("",!0)]),t("div",Le,[e[41]||(e[41]=t("h3",null,"ðŸ‘¤ Informazioni Artista",-1)),l.value.artist?.photo?(o(),p("div",Ve,[e[33]||(e[33]=t("strong",null,"Foto Artista:",-1)),t("div",Be,[t("img",{src:l.value.artist.photo,alt:l.value.artist.name},null,8,Ie)])])):d("",!0),t("div",ze,[e[34]||(e[34]=t("strong",null,"Nome:",-1)),t("span",null,n(l.value.artist.name),1)]),t("div",Ee,[e[35]||(e[35]=t("strong",null,"Email:",-1)),t("span",null,n(l.value.artist.email),1)]),t("div",Fe,[e[36]||(e[36]=t("strong",null,"Biografia:",-1)),t("p",null,n(l.value.artist.bio),1)]),J(l.value)?(o(),p("div",Ue,[e[40]||(e[40]=t("strong",null,"Social:",-1)),t("div",Oe,[l.value.artist.socialLinks?.instagram?(o(),p("a",{key:0,href:l.value.artist.socialLinks.instagram,target:"_blank"},[...e[37]||(e[37]=[t("i",{class:"pi pi-instagram"},null,-1),m(" Instagram ",-1)])],8,Ge)):d("",!0),l.value.artist.socialLinks?.soundcloud?(o(),p("a",{key:1,href:l.value.artist.socialLinks.soundcloud,target:"_blank"},[...e[38]||(e[38]=[t("i",{class:"pi pi-cloud"},null,-1),m(" Soundcloud ",-1)])],8,Me)):d("",!0),l.value.artist.socialLinks?.mixcloud?(o(),p("a",{key:2,href:l.value.artist.socialLinks.mixcloud,target:"_blank"},[...e[39]||(e[39]=[t("i",{class:"pi pi-cloud"},null,-1),m(" Mixcloud ",-1)])],8,We)):d("",!0)])])):d("",!0)]),t("div",He,[e[45]||(e[45]=t("h3",null,"ðŸ“… Programmazione",-1)),t("div",Je,[e[42]||(e[42]=t("strong",null,"Giorno:",-1)),t("span",null,n(l.value.schedule.dayOfWeek),1)]),t("div",Ke,[e[43]||(e[43]=t("strong",null,"Fascia Oraria:",-1)),t("span",null,n(l.value.schedule.timeSlot),1)]),t("div",Qe,[e[44]||(e[44]=t("strong",null,"Frequenza:",-1)),t("span",null,n(l.value.schedule.frequency),1)])]),l.value.adminNotes?(o(),p("div",Xe,[e[46]||(e[46]=t("h3",null,"ðŸ’¬ Note Admin",-1)),t("p",null,n(l.value.adminNotes),1)])):d("",!0),t("div",Ye,[e[49]||(e[49]=t("h3",null,"ðŸ“Š Info Sistema",-1)),t("div",Ze,[e[47]||(e[47]=t("strong",null,"Data Richiesta:",-1)),t("span",null,n(x(l.value.createdAt)),1)]),t("div",Pe,[e[48]||(e[48]=t("strong",null,"Ultimo Aggiornamento:",-1)),t("span",null,n(x(l.value.updatedAt)),1)])])])):d("",!0)]),_:1},8,["visible"]),i(se)]),_:1})}}},it=ue(et,[["__scopeId","data-v-a1123993"]]);export{it as default};
